(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[108],{68:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/ReviewEntries",function(){return r(6822)}])},9248:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(4848),s=r(6540);let n=e=>{let{restaurants:t,review:r,onSubmit:n}=e,[i,o]=(0,s.useState)(t[0].name),[l,c]=(0,s.useState)(1),[d,u]=(0,s.useState)("");return(0,s.useEffect)(()=>{if(r){var e,t,a;o((null===(e=r.restaurant)||void 0===e?void 0:e.toString())||""),c((null===(t=r.rating)||void 0===t?void 0:t.valueOf())||1),u((null===(a=r.comment)||void 0===a?void 0:a.toString())||"")}},[r]),(0,a.jsx)("div",{children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();try{n({restaurant:i,rating:l,comment:d}),o(""),c(1),u("")}catch(e){e instanceof Error&&alert("Error: ".concat(e.message)),console.error("An error occurred when posting review: ",e)}},children:[(0,a.jsx)("label",{htmlFor:"review-restaurant",children:"Review a Restaurant: "}),(0,a.jsx)("select",{id:"review-restaurant",name:"review-restaurant",value:i,onChange:e=>o(e.target.value),children:t&&t.length>0?t.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e._id.toString())):(0,a.jsx)("option",{value:"",disabled:!0,children:"No restaurants available"})}),(0,a.jsx)("br",{}),(0,a.jsx)("br",{}),(0,a.jsx)("label",{htmlFor:"review-rating",children:"Select your rating: "}),(0,a.jsxs)("select",{id:"review-rating",name:"review-rating",value:l,onChange:e=>c(Number(e.target.value)),children:[(0,a.jsx)("option",{value:"1",children:"1"}),(0,a.jsx)("option",{value:"2",children:"2"}),(0,a.jsx)("option",{value:"3",children:"3"}),(0,a.jsx)("option",{value:"4",children:"4"}),(0,a.jsx)("option",{value:"5",children:"5"})]}),(0,a.jsx)("br",{}),(0,a.jsx)("br",{}),(0,a.jsx)("label",{htmlFor:"review-comment",children:"Leave a Comment: "}),(0,a.jsx)("textarea",{id:"review-comment",name:"review-comment",value:d,onChange:e=>u(e.target.value)}),(0,a.jsx)("br",{}),(0,a.jsx)("br",{}),(0,a.jsx)("button",{className:"submit-buttons",type:"submit",children:"Post Review"})]})})}},6822:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var a=r(4848),s=r(6540),n=r(9248);let i=e=>{let{restaurants:t,review:r,onClose:s,onSubmit:i}=e;return(0,a.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,a.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:"Update a Review"}),(0,a.jsx)("br",{}),(0,a.jsx)(n.A,{review:r,onSubmit:e=>{i(r._id,e),s()},restaurants:t})]}),(0,a.jsx)("button",{onClick:s,children:"Close"})]})})},o=e=>{let{restaurants:t,reviews:r,onDeleteSubmit:n,onUpdateSubmit:o}=e,[l,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),h=e=>{u(e),c(!0)},v=async e=>{try{await n(e)}catch(e){e instanceof Error&&alert("Error: ".concat(e.message)),console.error("An error occurred when deleting the post: ",e)}};return(0,a.jsxs)("div",{className:"reviewCards",children:[r.map(e=>(0,a.jsxs)("div",{className:"review",children:[(0,a.jsxs)("p",{children:["Restaurant: ",e.restaurant]}),(0,a.jsxs)("p",{children:["Rating: ",e.rating]}),(0,a.jsxs)("p",{children:["Comment: ",e.comment]}),(0,a.jsxs)("p",{children:["Created At: ",e.createdAt]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{className:"other-buttons",onClick:()=>h(e),children:"Update"}),(0,a.jsx)("button",{className:"other-buttons",onClick:()=>v(e._id),children:"Delete"})]})]},e._id)),l&&d&&(0,a.jsx)(i,{restaurants:t,review:d,onClose:()=>c(!1),onSubmit:o})]})},l=e=>{let{restaurants:t,onClose:r,onReviewSubmit:s}=e;return(0,a.jsx)("div",{className:"modal-overlay",onClick:r,children:(0,a.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:"Write a Review"}),(0,a.jsx)("br",{}),(0,a.jsx)(n.A,{restaurants:t,onSubmit:e=>{s(e)}})]}),(0,a.jsx)("button",{onClick:r,children:"Close"})]})})},c=e=>{let{restaurants:t}=e,[r,n]=(0,s.useState)([]),[i,c]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/reviews");if(!e.ok)throw Error("HTTP error! Status: ".concat(e.status));let t=(await e.json()).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime());n(t)}catch(e){console.error("An error occurred when fetching data: ",e)}})()},[]);let d=async e=>{try{let t=await fetch("/api/reviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw alert("Please login."),Error("HTTP error! Status: ".concat(t.status));let r=await t.json();r&&(n(e=>[r,...e].sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime())),c(!1))}catch(e){console.error("An error occurred when posting review: ",e)}},u=async(e,t)=>{try{let r=await fetch("/api/reviews/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw alert("Please login."),Error("HTTP error! Status: ".concat(r.status));let a=await r.json();n(e=>e.map(e=>e._id===a._id?a:e)),console.log("Post updated successfully!")}catch(e){console.error("An error occurred when updating post: ",e)}},h=async e=>{try{let t=await fetch("/api/reviews/".concat(e),{method:"DELETE"});if(!t.ok)throw alert("Please login."),Error("HTTP error! Status: ".concat(t.status));let r=await t.json();n(e=>e.map(e=>e._id===r._id?r:e)),console.log("Review deleted successfully!")}catch(e){console.error("An error occurred when deleting a review post: ",e)}};return(0,a.jsxs)("div",{className:"pages",children:[(0,a.jsx)("h3",{children:"Reviews"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{className:"other-buttons",onClick:()=>c(!0),children:"+ Add Review"}),i&&(0,a.jsx)(l,{restaurants:t,onClose:()=>c(!1),onReviewSubmit:d})]}),(0,a.jsx)(o,{restaurants:t,reviews:r,onDeleteSubmit:h,onUpdateSubmit:u})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(68)),_N_E=e.O()}]);